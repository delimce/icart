<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta charset="utf-8">
        <link rel="stylesheet" href="css/jquery.mobile.structure.min.css" />
        <link rel="stylesheet" href="css/icart.min.css" />
        <link rel="stylesheet" href="css/style.css" />
        <script src="cordova.js"></script>
        <script src="barcodescanner.js"></script>
        <script src="js/appConfig.js"></script>
        <script src="js/jquery/jquery.min.js"></script>
        <script src="js/jquery/jquery.mobile.min.js"></script>
        <script src="js/vendor/functions.js"></script>
        <script>

            function onDeviceReady() {

                ///funcion de carga
                document.addEventListener("backbutton", exitAppl, false);


                $("#salir").click(function() {

                    vibrate(300);
                    exitAppl();

                });

                ///funcion de carga y captura
                $("#captura").click(function() {

                    //var cod = randomFromInterval(1, 5000000);
                    //infoProducto(cod);
                     escanear();


                });


                var escanear = function() {
                    $("#productInfo").hide();
                    window.plugins.barcodeScanner.scan(
                            function(result) {
                                if (result.cancelled) {
                                    alert("operacion cancelada por el usuario");
                                } else {
                                    // alert("we got a barcode: " + result.text);
                                    var cod = result.text;
                                    infoProducto(cod);
                                }
                            },
                            function(error) {
                                alert("scanning failed: " + error)
                            }
                    );

                }


            }


            function infoProducto(cod) {


                cadena = String(cod);
                randy = cadena.substring(cadena.length - 1, cadena.length);

                $("#productInfo").show();
                $("#nombre").html(nombres[randy]);
                $("#codigo").html(cod);
                $("#precio").html('Bs. ' + precios[randy]);
                $("#cantidad").val(1);


                var current = (randy <= 5) ? '<img src="images/00' + randy + '.jpg"/>' : '<br><br><br>IMAGEN NO DISPONIBLE';
                $("#publicidad").html(current);

            }


        </script>


    </head>
    <body onload="init();">


        <!--lobi-->
        <div data-role="page" id="index">
            <div class="intro"><img src="css/images/logo.png"/></div>
            <div>
                <a href="#miCarrito"  data-role="button" data-transition="turn">Mi Carrito</a>
                <a href="#" data-role="button" data-transition="turn">Mi Lista</a>
                <a href="#" id="salir" data-role="button" data-transition="turn">Salir</a>
            </div>             
        </div>



        <!--mi carrito-->
        <div data-role="page" id="miCarrito">
            <div data-role="header">
                <a href="#index" data-transition="turn" data-direction="reverse" data-icon="back">atrás</a>
                <h1>Mi Carrito</h1>
            </div>


            <div id="publicidad" class="advertising"><br><br>Su Publicidad Aqui!</div>

            <article>
                <div style="text-align: center; border-bottom: 2pt;">
                    <a href="#" id="captura" data-role="button" data-inline="true" data-transition="turn">Capturar Nuevo</a>
                </div>
                <hr>
                <div id="productInfo" style="display: none">
                    <div class="separador"> 
                        <span class="label">Producto</span>
                        <span id="nombre">&nbsp;</span>
                    </div>
                    <div class="separador"> 
                        <span class="label">Código</span>
                        <span id="codigo">&nbsp;</span>
                    </div>

                    <div class="separador"> 
                        <span class="label">Precio</span>
                        <span id="precio">&nbsp;</span>
                    </div>

                    <div class="separador" data-role="fieldcontain"> 
                        <span class="label">Cantidad</span>
                        <textarea name="cantidad" id="cantidad">1</textarea>
                       
                    </div>

                </div>

            </article> 


        </div>

    </body>
</html>
